  

LAN (Local Area Network) 들이 연결되면 WAN(Wide Area network)

우리가 구축할 것은 주로 WAN

  
OSI 7계층(이론상) , TCP / IP Layer(4계층)(실제 구현 모습)

클라우드 → Application / Transport / Internet 계층만 인지하면 됨

  

TCP / UDP 해당 시스템에서 어떤 시스템에 접근할지 선택

- 포트번호를 사용 ((TCP)웹 - 80 / FTP - 21 / DNS - 53(UDP)
- wellknown port : 각 시스템 마다 약속된 포트번호가 존재.

  

1. 전송하고자 하는 Data를 OSI 7계층을 통해 적절한 목적지 위치의 정보를 담는다.
2. 이후 전송 과정에서 각 장비(스위치, 라우터.. 등)에서 정보를 처리함으로서 목적지로 해당 Data가 온전히 전송될 수 있도록 도와준다.

  

라우터 : 3계층 장비(3계층까지의 정보를 읽을 수 있다.)

스위치 : 2계층 장비(2계층 까지의 정보를 담을 수 있다.)

  

Layer 3 : IP 주소 (사용자의 입력)

L4 : TCP / UDP , 포트 번호 (고정)

L7 : SSH, TELNET, DNS, FTP, HTTP

  

ex) https://www.naver.com

1. DNS 동작. → IP주소로 변환하여 접속
    
    (https://x.x.x.x → 목적지, 네이버의 서버 주소(IP))
    
2. https: TCP443 포트번호 사용.

  

L4 이후 계층을 이용하는 것 부터 포트번호를 사용한다.

L3 이하의 프로토콜은 포트번호가 존재하지 않는다.

  

서비스에 접속하기 위해 필요한 정보

1. IP주소 (사용자가 원하는 것 선택)
2. TCP / UDP 포트 번호 (1, 3 번에 따라 자동 선택됨)
3. 서비스 프로토콜 (사용자가 원하는 것 선택)

  

Ping (ICMP 사용) : 핑의 응답 여부에 따라 네트워크의 동작 여부 판단.

  

WireShark - OSI 7계층 변환 과정을 capture 해서 볼 수 있는 분석 프로그램.

- port number : 1 ~ 65535
- 1~1023 : Well Known Port Number
- client port number : 1024 ~ 65535 (Well Known Port Num 을 제외하고 random 하게 지정됨.)

  

![[%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-06-29_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_11.36.13.png]]

방화벽 : IP 주소, TCP / UDP 포트 번호를 사용해서 트래픽을 제어.

  

  

### IP 주소의 (class)

  

![[%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-06-26_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.25.45.png]]

  

A class(1~126) : /8

B class(128 ~ 191) : /16

C class(192~223) : /24

  

같은 (동일)네트워크 - 네트워크 주소가 같은 네트워크

subnet mask : 어디까지가 네트워크 주소인지 판별하기 위한 도구. (255.255.x.x)

subnet mask가 같으면 동일 네트워크. (스위치 등의 타 장비의 도움 없이 서로 통신이 가능한 네트워크)

  

**prefix - 네트워크 비트 개수**

255.255.255.0 → 1비트가 24개 (255는 2진수로 11111111)

따라서 prefix 로 변환 시, 255.255.255.0/24 으로 나타낸다.

- 보통 16 비트로 나타낸다.
- ex) 172.16.0.0/16

  

만약, subnet mask도, prefix 도 없다면 각 클래스의 범위에 따라 prefix 로 default 값이 설정 되어 있는 것.

- ex) 172.16.2.2 → B class 에 해당하므로 /16 의 prefix를 가지고 있는 것.
- 10.1.1.1 → A class 에 해당하므로 /8 의 prefix를 가지고 있는 것.

  

위 처럼 다른 네트워크(172.16.2.2 ↔ 10.1.1.1)를 가진 시스템과 통신하려면, L2 장비( switch → MAC 주소만 읽기 가능하며, IP주소는 읽지 못하는 장비) 가 아닌, L3 장비인 라우터(라우팅 테이블) 이상을 필요로 한다.

- 라우팅 테이블에 정보가 없으면 통신이 불가.
- 정보가 없을시 기본 게이트웨이를 사용하여 무조건 외부로 보냄으로서 통신을 가능하게 할 수 있으나 여기서 기본 게이트웨이가 설정되어 있지 않을 시 통신 불가.

  

공인 IP - 유일한 주소

  

사설 IP - 중복이 가능한 주소 (인터넷 불가 - 유일하지 않기 때문에)

  

**사설 IP 대역 목록 (VPC 가상네트워크 구축 시 사용하는 네트워크)**

1. ~ 으로 시작

172.16. ~ 으로 시작

192.168. ~ 으로 시작

169.254 ~ 으로 시작 (IP 주소 자동 할당 과정에서 자동 할당 받기 실패 시 설정되는 주소 - 외부와의 통신은 불가하며, 내부 통신만 가능하다.)

  

IP 주소 - 2^32 개 (42억)

  

- L3 이상의 장비에는 모두 routing table과 그 정보가 존재한다.
- 해당 정보가 정확한 정보를 담고 있어야 비로소 통신이 가능하게 된다.

  

## 정리

1. 원격 시스템 간의 통신 원리 (유 / 무선 차이는 없다. 그 형태만 다를 뿐)
2. L2, L3 동작 내용

- 시스템 간의 통신 방식
    - IP주소
    - 서버에서 제공하는 서비스의 종류 (TELNET..등)
    - 서버에서 제공하는 서비스의 종류에 대응하는 클라이언트 프로그램 및 포트번호(well known port number를 사용하지 않을 시)
- 서버: HTTP TCP 80 , 클라이언트: 웹 브라우저
- 서버: SSH TCP 22, 클라이언트 : SSH 클라이언트
- 서버: FTP 21 , 클라이언트 : FTP 클라이언트
    - 위와 같이 Well Known port가 아닌 직접 설정한 port number 를 사용하면 port number를 클라이언트 프로그램에서 추가적으로 설정해주어야 한다. ex) 서버: TCP 2222 클라이언트: SSH -p 2222 x.x.x.x
- 서버에서 TELNET 서비스가 동작한다 → TCP 23 포트 Listening 중

1. L4 ~ L7: 목적지 시스템 내에서 데이터를 처리하기 위해 사용되는 정보
2. IP 주소 : 네트워크 비트를 사용하여 IP 주소 내에서 네트워크 주소의 범위를 알 수 있음.
    
    네트워크 비트 :
    
    - 과거 : subnet mask (255.255.255.x) → 24 비트까지가 네트워크 주소
    - 현재 : prefix (/16) → 16 비트까지가 네트워크 주소
    
    네트워크 비트가 설정되어 있지 않으면, default로 설정 된 것인데,
    
    default는 class 단위로 설정된다,.
    
    - A class : 1 ~ 126 : /8 의 prefix 를 가짐
        - 0 : 모든 네트워크를 의미.
        - 127 : loop back 주소. (자기 자신의 주소)
    - B class : 128 - 191 : /16 의 prefix 를 가짐
    - C class : 192 ~ 223 : /24 의 prefix 를 가짐

  

172.16.1.100

172.16.2.100

위 두 가지 주소는 같은 네트워크 이므로 L2 장비 (switch) 만 사용해도 통신이 가능하다.

  

192.168.100.100

하지만 위의 주소는 C class 에 포함되어 다른 네트워크가 되므로 L3 이상의 장비가 있어야 172. ~ 네트워크와 통신이 가능해진다.

  

VPC: Virtual Private Cloud

추가적으로 2개 이상의 VPC 연결시에는 peering이란 서비스만으로 가능.

3개 이상의 VPC 연결시에는 TGW(Transit Gateway : 가상의 라우터) 라는 장비를 사용해서 routing table을 통해 연결이 가능해진다.

  

subneting : 주어진 네트워크를 분할하기